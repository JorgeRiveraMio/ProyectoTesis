@model ProyectoTesis.Models.TBT_PREGUNTA 
@{
    ViewData["Title"] = "Preguntas del Test";
    var totalPreguntas = ViewBag.TotalPreguntas;
    var numeroActual = ViewBag.NumeroActual;
    var moduloId = ViewBag.ModuloId;

    var progresoActual = (numeroActual * 100) / totalPreguntas;
    var progresoAnterior = ((numeroActual - 1) * 100) / totalPreguntas;
}

<style>
    .liquid-bar {
        background: linear-gradient(
            270deg,
            #38bdf8,
            #0ea5e9,
            #0284c7
        );
        background-size: 600% 600%;
        animation: waveAnimation 4s ease infinite;
        transition: width 1s cubic-bezier(0.4, 0, 0.2, 1); 
    }

    @@keyframes waveAnimation {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
</style>

<div class="flex flex-1 justify-center py-10 bg-slate-50" style='font-family: "Public Sans", "Noto Sans", sans-serif;'>
    <div class="layout-content-container flex flex-col w-full max-w-2xl">
        <div class="bg-white rounded-lg shadow-md p-8">

            <!-- Progreso -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <p class="text-slate-800 text-sm font-medium">Progreso del Test</p>
                    <p class="text-slate-500 text-sm">Pregunta @numeroActual de @totalPreguntas</p>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-2.5 overflow-hidden">
                    <div id="progress-bar"
                         class="liquid-bar h-2.5 rounded-full"
                         style="width:@progresoAnterior%">
                    </div>
                </div>
            </div>

            <!-- Pregunta -->
            <form asp-action="GuardarRespuesta" method="post" class="flex flex-col gap-8">
                <input type="hidden" name="sesionId" value="@ViewBag.SesionId" />
                <input type="hidden" name="moduloId" value="@ViewBag.ModuloId" />
                <input type="hidden" name="intentoId" value="@ViewBag.IntentoId" />
                <input type="hidden" name="IDD_PREGUNTA" value="@Model.IDD_PREGUNTA" />
                <input type="hidden" name="numeroActual" value="@numeroActual" />

                <h2 class="text-slate-900 text-lg font-semibold">@Model.DES_PREGUNTA_TX</h2>

                <!-- Escala Likert 1â€“5 (para RIASEC y OCEAN) -->
                <div class="grid grid-cols-5 gap-4">
                    @for (int val = 1; val <= 5; val++)
                    {
                        <label class="flex flex-col items-center gap-2 rounded-lg border border-solid border-slate-200 p-4 hover:bg-slate-50 cursor-pointer transition-colors has-[:checked]:border-[#13a4ec] has-[:checked]:bg-blue-50">
                            <input class="custom-radio h-5 w-5 appearance-none rounded-full border-2 border-slate-300 transition-all"
                                   type="radio"
                                   name="VAL_RESPUESTA_TX"
                                   value="@val" required />
                            <span class="text-slate-700 text-sm font-medium">@val</span>
                        </label>
                    }
                </div>

                <div class="flex justify-between mt-6">
                    @if (numeroActual > 1)
                    {
                        <a asp-action="MostrarPregunta"
                           asp-route-numero="@(numeroActual - 1)"
                           asp-route-moduloId="@ViewBag.ModuloId"
                           class="flex items-center justify-center rounded-lg h-12 px-6 bg-slate-200 text-slate-700 text-base font-bold hover:bg-slate-300 transition-colors">
                            <span class="material-symbols-outlined mr-2">arrow_back</span>
                            Anterior
                        </a>
                    }

                    <button type="submit"
                            class="flex items-center justify-center rounded-lg h-12 px-6 bg-[#13a4ec] text-white text-base font-bold hover:bg-blue-600 transition-colors">
                        @(numeroActual == totalPreguntas ? "Finalizar" : "Siguiente")
                        <span class="material-symbols-outlined ml-2">arrow_forward</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const bar = document.getElementById("progress-bar");
        if (bar) {
            setTimeout(() => {
                bar.style.width = "@progresoActual%";
            }, 100);
        }
    });
</script>
